<!--
    
 @Name：不落阁整站模板源码
 @Author：Absolutely
 @Site：http://www.lyblogs.cn

 -->

<!DOCTYPE html>

<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
    <meta http-equiv="Content-Type" content="text/html; Charset=gb2312">
    <meta http-equiv="Content-Language" content="zh-CN">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <title>WAITER</title>
    <link rel="shortcut icon" th:href="@{/images/Logo_40.png}" type="image/x-icon">
    <!--Layui-->
    <link th:href="@{/plug/layui/css/layui.css}" rel="stylesheet" />
    <!--font-awesome-->
    <link th:href="@{/plug/font-awesome/css/font-awesome.min.css}" rel="stylesheet" />
    <!--全局样式表-->
    <link th:href="@{/css/global.css}" rel="stylesheet" />
    <!-- 本页样式表 -->
    <link th:href="@{/css/home.css}" rel="stylesheet" />
</head>
<body>
    <!-- 导航 -->
    <div th:replace="common/common::top(activeUri='index')"></div>
    <!-- 主体（一般只改变这里的内容） -->
    <div class="blog-body">
        <!-- canvas -->
        <canvas id="canvas-banner" style="background: #393D49;"></canvas>
        <!--为了及时效果需要立即设置canvas宽高，否则就在home.js中设置-->
        <script type="text/javascript">
            var canvas = document.getElementById('canvas-banner');
            canvas.width = window.document.body.clientWidth - 10;//减去滚动条的宽度
            if (screen.width >= 992) {
                canvas.height = window.innerHeight * 1 / 3;
            } else {
                canvas.height = window.innerHeight * 2 / 7;
            }
        </script>
        <!-- 这个一般才是真正的主体内容 -->
        <div class="blog-container">
            <div class="blog-main">
                <!-- 网站公告提示 -->
                <div class="home-tips shadow">
                    <i style="float:left;line-height:17px;" class="fa fa-volume-up"></i>
                    <div class="home-tips-container">
                        <span style="color: #009688">HHHHHHHHHHHHHHHHHHHHHHHHH</span>
                        <span style="color: #009688">EEEEEEEEEEEEEEEEEEEEEEEEEE</span>

                    </div>
                </div>
                <!--左边文章列表-->
                <div  class="blog-main-left">
                    <div th:each="doc:${docs}" class="article shadow">


                        <div class="article-left">
                            <img src="../images/cover/201703181909057125.jpg" th:alt="${doc.title}" />
                        </div>
                        <div  class="article-right">
                            <textarea th:hidden="true">[[${doc.body}]]</textarea>
                            <div  class="article-title">
                                <a th:href="@{/doc/}+${doc.id}" ><h2>[[${doc.title}]]</h2></a>
                            </div>
                            <div class="article-abstract">
                                [[${doc.subTitle}]]
                            </div>

                        </div>
                        <div class="clear"></div>
                        <div class="article-footer">
                            <span><i class="fa fa-clock-o"></i>&nbsp;&nbsp;[[${#dates.format(doc.create, 'yyyy-MM-dd')}]]</span>
                            <span class="article-author"><i class="fa fa-user"></i>&nbsp;&nbsp;[[${doc.author}]]</span>
                            <span><i class="fa fa-tag"></i>&nbsp;&nbsp;<a href="#">[[${doc.type.name}]]</a></span>
                            <span class="article-viewinfo"><i class="fa fa-eye"></i>&nbsp;[[${doc.watch.count}]]</span>
                            <span class="article-viewinfo comment_count" th:id="${doc.id}" ><h3 th:hidden="true"  class="doc_id">[[${doc.id}]]</h3></span>
                        </div>
                    </div>

                </div>
                <!--右边小栏目-->
                <div class="blog-main-right">
                    <div class="blogerinfo shadow">
                        <div class="blogerinfo-figure">
                            <img src="../images/Absolutely.jpg" alt="Absolutely" />
                        </div>
                        <p class="blogerinfo-nickname">WAITER</p>
                        <p class="blogerinfo-introduce">一枚90后程序员，JAVA开发工程师</p>
                        <p class="blogerinfo-location"><i class="fa fa-location-arrow"></i>&nbsp;中国 - 青岛</p>
                        <hr />
                        <div class="blogerinfo-contact">
                            <a target="_blank" title="QQ交流" href="javascript:layer.msg('启动QQ会话窗口')"><i class="fa fa-qq fa-2x"></i></a>
                            <a target="_blank" title="给我写信" href="mailto:1403976416@qq.com"><i class="fa fa-envelope fa-2x"></i></a>
                            <a target="_blank" title="github" href="https://github.com/waiter2020"><i class="fa fa-git fa-2x"></i></a>
                        </div>
                    </div>
                    <div></div><!--占位-->
                    <div class="blog-module shadow">
                        <div class="blog-module-title">热文排行</div>
                        <ul class="fa-ul blog-module-ul">
                            <li th:each="h:${hot}"><i class="fa-li fa fa-hand-o-right"></i><a th:href="@{/doc/}+${h.id}" th:value="${h.title}">[[${h.title}]]</a></li>
                            <!--<li><i class="fa-li fa fa-hand-o-right"></i><a href="detail.html">ASP.NET MVC 防范跨站请求伪造（CSRF）</a></li>-->
                            <!--<li><i class="fa-li fa fa-hand-o-right"></i><a href="detail.html">常用正则表达式</a></li>-->
                            <!--<li><i class="fa-li fa fa-hand-o-right"></i><a href="detail.html">EF CodeFirst数据迁移常用指令</a></li>-->
                            <!--<li><i class="fa-li fa fa-hand-o-right"></i><a href="detail.html">浅谈.NET Framework基元类型</a></li>-->
                            <!--<li><i class="fa-li fa fa-hand-o-right"></i><a href="detail.html">C#基础知识回顾-扩展方法</a></li>-->
                            <!--<li><i class="fa-li fa fa-hand-o-right"></i><a href="detail.html">一步步制作时光轴（一）（HTML篇）</a></li>-->
                            <!--<li><i class="fa-li fa fa-hand-o-right"></i><a href="detail.html">一步步制作时光轴（二）（CSS篇）</a></li>-->
                        </ul>
                    </div>
                    <div class="blog-module shadow">
                        <div class="blog-module-title">最近分享</div>
                        <ul class="fa-ul blog-module-ul">
                            <li><i class="fa-li fa fa-hand-o-right"></i><a href="http://pan.baidu.com/s/1c1BJ6Qc" target="_blank">Canvas</a></li>
                            <li><i class="fa-li fa fa-hand-o-right"></i><a href="http://pan.baidu.com/s/1kVK8UhT" target="_blank">pagesize.js</a></li>
                            <li><i class="fa-li fa fa-hand-o-right"></i><a href="https://pan.baidu.com/s/1mit2aiW" target="_blank">时光轴</a></li>
                            <li><i class="fa-li fa fa-hand-o-right"></i><a href="https://pan.baidu.com/s/1nuAKF81" target="_blank">图片轮播</a></li>
                        </ul>
                    </div>
                    <div class="blog-module shadow">
                        <div class="blog-module-title">一路走来</div>
                        <dl class="footprint">
                            <dt>2017年03月12日</dt>
                            <dd>新增留言回复功能！人人都可参与回复！</dd>
                            <dt>2017年03月10日</dt>
                            <dd>不落阁2.0基本功能完成，正式上线！</dd>
                            <dt>2017年03月09日</dt>
                            <dd>新增文章搜索功能！</dd>
                            <dt>2017年02月25日</dt>
                            <dd>QQ互联接入网站，可QQ登陆发表评论与留言！</dd>
                        </dl>
                    </div>
                    <div class="blog-module shadow">
                        <div class="blog-module-title">后台记录</div>
                        <dl class="footprint">
                            <dt>2017年03月16日</dt>
                            <dd>分页新增页容量控制</dd>
                            <dt>2017年03月12日</dt>
                            <dd>新增管家提醒功能</dd>
                            <dt>2017年03月10日</dt>
                            <dd>新增Win10快捷菜单</dd>
                        </dl>
                    </div>
                    <div class="blog-module shadow">
                        <div class="blog-module-title">友情链接</div>
                        <ul class="blogroll">
                            <li><a target="_blank" href="http://www.layui.com/" title="Layui">Layui</a></li>
                        </ul>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
        </div>
    </div>
    <!-- 底部 -->
    <div th:replace="common/common::footer"></div>
    <div th:replace="common/common::left(activeUri='index')"></div>
    <div th:replace="common/common::share"></div>




    <!--遮罩-->
    <div class="blog-mask animated layui-hide"></div>
    <!-- layui.js -->
    <script th:src="@{/plug/layui/layui.js}"></script>
    <!-- 全局脚本 -->
    <script th:src="@{/js/global.js}"></script>
    <!-- 本页脚本 -->
    <script th:src="@{/js/home.js}"></script>
    <script th:src="@{/editor/examples/js/jquery.min.js}"></script>

</body>
<script>
    var docs = $(".article");
    for(var i=0;i< docs.length;i++){
        var text=docs[i].getElementsByTagName("textarea")[0].value;
        var regexp = /!\[\]\((.*?)\)/g;

        while((result=regexp.exec(text))!==null) {

                var img =docs[i].getElementsByTagName("img")[0];
                img.src=result[1];

        }
    }
    // var text=docs[0].getElementsByTagName("textarea");
    // console.log(text[0].value);
    // var regexp = /!\[\]\((.*?)\)/g;
    // var str=text[0].value;
    // while((result=regexp.exec(str))!==null){
    //     console.log(result[1])
    // }
</script>
<script>
    var ids = $(".doc_id");
    for (var i=0;i<ids.length;i++) {
         var id = ids[i].innerText;

        $.ajax({
            url: "/comment/get_count/"+id,
            type: "get",
            contentType: "application/json;charset=utf-8",
            dataType: 'json',
            async: true,
            success: function(result){
                $("#"+result.id).html("<i class=\"fa fa-commenting\"></i>&nbsp;"+result.count);
            }});
    }

</script>
</html>